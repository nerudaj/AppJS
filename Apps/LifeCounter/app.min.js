"use strict";var version="3.0.0",va=1,vb=!1;function fa(a){return document.getElementById(a)}function fb(a,b,c){var d="ERROR: "+a+"::"+b+": "+c;console.error(d),0<va&&alert(d)}function fc(a,b){return Math.floor(Math.random()*b+a)}function fd(a,b){return"undefined"==typeof a?b:a}function fe(a,b,c,d,e,f){var g=1,h=fd(d,100);b*=fd(e,.8),c*=fd(f,.8);var i=fa("HiddenResizer");for(i.innerHTML=a;1<h-g;){var j=parseInt((g+h)/2);i.style.fontSize=j+"px",i.offsetWidth<=b&&i.offsetHeight<=c?g=j:h=j}return g}function ff(){this.dom=null,this.width=0,this.height=0}ff.prototype.pa=function(a,b,c,d,e,f){e=fd(e,"div"),f=fd(f,null);var g=new ff,h=document.createElement(e);return null!=f&&h.setAttribute("id",f),this.dom.appendChild(h),g.dom=h,g.width=this.width*c,g.height=this.height*d,g.dom.style.position="absolute",g.dom.style.left=this.width*a+"px",g.dom.style.top=this.height*b+"px",g.dom.style.width=g.width+"px",g.dom.style.height=g.height+"px","input"==e&&(g.pe("focus",()=>{vb=!0}),g.pe("blur",()=>{setTimeout(()=>{vb=!1},500)})),g},ff.prototype.pb=function(a){this.dom.style.background=a},ff.prototype.pc=function(a,b,c){b=fd(b,!1);var d=null;b?(c=fd(c,100),d=fe(a,this.width,this.height,c)):"undefined"!==c&&(d=c);var e=document.createTextNode(a);null!=d&&(this.dom.style.fontSize=d+"px"),this.dom.appendChild(e)},ff.prototype.pd=function(a){this.dom.className+=" "+a},ff.prototype.pe=function(a,b){this.dom.addEventListener(a,b)},ff.prototype.pf=function(a){this.pe("click",a)};function fg(){}fg.prototype.pg=function(){fb("ClassView","render","This method is not implemented!")};function fh(){this.ia={},this.ij=new ff,this.views={},this.currentView=""}fh.prototype.ph=function(a,b){var c=this.views;return c.hasOwnProperty(b)?(fb("ClassApp","addView","View with name "+b+" already exists!"),!1):(c[b]=a,!0)},fh.prototype.pi=function(a){return this.views.hasOwnProperty(a)?void(this.currentView=a,this.pg(),vb=!1):void fb("ClassApp","toggleView","View called "+a+" does not exist!")},fh.prototype.pg=function(){var a=this.ij;a.dom.innerHTML="",a.width=window.innerWidth,a.height=window.innerHeight,a.dom.style.position="absolute",a.dom.style.width=a.width+"px",a.dom.style.height=a.height+"px",this.views[this.currentView].pg()},fh.prototype.pj=function(a){this.ij.dom=fa(a),window.addEventListener("resize",()=>{vb||(fr(),this.pg())})};var vc=fk;function fi(){var a=fJ(ve.ij,vj,[new fE(vk,()=>{vc=fk,fj()}),new fE(vl,()=>{vc=fl,fj()}),new fE(vn,()=>{ve.pi(0)})],"a"),b=ve.ia.im?.1:0,c=1-b;a.pf(()=>{fj()});var d=a.pa(0,0,1,c,"div","b"),e=fe(fp([vF[0].repeat(ve.ia.diceCount),vo,vp]),a.width,a.height,Math.min(a.width,a.height));if(d.pc("??",!1,e),ve.ia.im){var f=a.pa(0,c,1,b,"div","c"),g=fs(f,1,1,"Lorem ipsum dolor sit amet","d",150);f.pc(ve.ia.in,!1,g),f.pd("align_left"),f.pd("nowrap")}}function fj(){fa("b").innerHTML="...",setTimeout(()=>{vc(),fm()},500)}function fk(){var a=fa("b");a.innerHTML="";for(var b=0;b<ve.ia.diceCount;b++)a.innerHTML+=vF[fc(1,6)-1]}function fl(){fa("b").innerHTML=[vo,vp][fc(1,2)-1]}function fm(){var a=ve.ia;if(a.im){var b="";a.in&&(b=", "),a.in=fa("b").innerHTML+b+a.in.substr(0,1024),fa("c").innerHTML=a.in}}function fn(){this.score=0,this.ik=0,this.color="red"}function fo(a){var b="0"+(Math.floor(a/60)+"");return b.slice(-2)+":"+("0"+(a%60+"")).slice(-2)}function fp(a){return a.reduce(function(c,a){return c.length>a.length?c:a})}function fq(a){return clearInterval(a),null}var vd={};function fr(){vd={}}function fs(a,b,c,d,e,f){var g=fd(f,100);return null==vd[e]&&(vd[e]=fe(d,a.width*b,a.height*c,g)),vd[e]}var ve=new fh;fh.prototype.pk=function(){this.backup=JSON.parse(JSON.stringify(this.ia))},fh.prototype.pl=function(){this.ia=JSON.parse(JSON.stringify(this.backup))};function Main(){ve.pj("Canvas"),ve.backup={},ve.ia.ib=[],ve.ia.ic=0,ve.ia.io=0,ve.ia.id=4,ve.ia.ie=[0,1,2,3,4,5,6,7],ve.ia["if"]=30,ve.ia.ig=0,ve.ia.ih=null,ve.ia.il=!1,ve.ia.im=!1,ve.ia["in"]="",ve.ia.diceCount=3;for(var a=0;a<ve.ia.id;a++)ve.ia.ib.push(new fn),ve.ia.ib[a].score=ve.ia.ic,ve.ia.ib[a].color=vf[ve.ia.ie[a]];for(var b,c=[{ii:ft,name:0},{ii:fx,name:1},{ii:fK,name:2},{ii:fN,name:3},{ii:fi,name:4}],a=0;a<c.length;a++)b=new fg,b.pg=c[a].ii,ve.ph(b,c[a].name);ve.pi(0)}function ft(){var a=fJ(ve.ij,"",[new fE(vj,()=>{ve.pi(4)}),new fE(vr,()=>{ve.pi(2)}),new fE(vq,()=>{ve.pk(),ve.pi(1)})],"e");a.dom.className="",fu(a)}function fu(a){for(var b=ve.ia.ib.length,c=2==b?1:2,d=Math.ceil(b/c),e=1/c,f=1/d,g=0,h=0;h<d;h++)for(var i=0;i<c;i++)if(1==b%2&&g+1==b&&(e=1),[5,6].forEach(b=>{var c=a.pa(i*e,h*f,e,f,"div","f"+b+g);c.pb(ve.ia.ib[g].color),fv(g,c,b)}),fa("f6"+g).style.display="none",g++,b==g)return}function fv(a,b,c){var d=5==c?"score":"ik",e=fs(b,.25,1,"XX","g",250),f=ve.ia.ib,g=b.pa(.25,0,.5,1,"div","h"+d+a);g.dom.style.fontSize=e+"px",6==c&&g.pd("outline"),ve.ia.il&&g.pf(()=>{b.dom.style.display="none",fa("f"+(5==c?6:5)+a).style.display=""}),["-","+"].forEach((c,g)=>{var h=b.pa(.75*g,0,.25,1,"button");h.pc(c,!1,e),h.pf(()=>{fw(f,a,parseInt(c+"1"),!1,d)}),h.pd("score_btn")}),fw(f,a,f[a][d],!0,d)}function fw(a,b,c,d,e){a[b][e]=(d?0:parseInt(a[b][e]))+c,fa("h"+e+b).innerHTML=a[b][e]}var vf=["red","lightgreen","lightblue","yellow","pink","orange","grey","#f5f5f5"];function fx(){var a=fJ(ve.ij,vq,[new fE(vm,()=>{fD(),ve.pi(0)}),new fE(vn,()=>{ve.pl(),ve.pi(0)})],"i");a.pd("scrollable");var b=Math.max(ve.ia.id+ve.ia.il+5,9),c=a.pa(0,0,1,b/9);fy(c,b)}function fy(a,b){var c=.6,d=1/b,e=[[(a,b)=>{fz(2,8,a,b)},"select","id",vx],[(a,b)=>{fz(1,6,a,b)},"select","diceCount",vw],[fB,"input","il",vu],[fB,"input","im",vv],[fA,"input","ic",vs],ve.ia.il?[fA,"input","io",vt]:null].filter(a=>a),f=fs(a,c,d,fp(e.map(a=>a[3])),"j");e.forEach((b,e)=>{var g=a.pa(0,e*d,c,d);g.pd("align_left"),g.pc(b[3],!1,f);var h=a.pa(c,e*d,1-c,.9*d,b[1]);b[0](h,b[2])});var g=e.length,h=a.pa(0,g++*d,1,d);h.dom.style.fontWeight="bold",h.pc(vy,!1,f);var i=a.pa(0,g*d,1,ve.ia.id*d);fC(i)}function fz(a,b,c,e){c.pe("change",a=>{var b=a.target;ve.ia[e]=parseInt(b.options[b.selectedIndex].value),ve.pi(1)});for(var f=a;f<=b;f++)(function(a){var b=c.pa(0,0,1,1,"option");b.value=f,b.pc(f),a==ve.ia[e]&&(b.dom.selected="selected")})(f)}function fA(a,b){a.dom.type="number",a.dom.value=ve.ia[b],a.dom.autocomplete="off",a.pe("input",()=>{a.dom.validity.valid&&(ve.ia[b]=a.dom.value)})}function fB(a,b){a.dom.type="checkbox",a.dom.checked=ve.ia[b],a.pf(()=>{ve.ia[b]=!ve.ia[b],ve.pi(1)})}function fC(a){for(var b=1/vf.length,c=1/ve.ia.id,d=0;d<ve.ia.id;d++)for(var e=0;e<vf.length;e++)(function(d,e){var f=a.pa(e*b,d*c,b,c);f.pb(vf[e]);var g="";ve.ia.ie[d]==e&&(g="checked"),f.dom.innerHTML="<input type=\"radio\" name=\"k"+d+"\" value=\""+e+"\" "+g+">",f.pf(()=>{ve.ia.ie[d]=e})})(d,e)}function fD(){for(var a=ve.ia,b=a.ib;a.id<b.length;)b.pop();for(;a.id>b.length;)b.push(new fn);for(var c=0;c<b.length;c++)b[c].color=vf[a.ie[c]],b[c].score=parseInt(a.ic),b[c].ik=parseInt(a.io)}var vg=.0807,vh=vg;function fE(a,b,c){this.label=a,this.action=b,this.id=fd(c,null)}function fF(a,b,c,d,e,f,g){var h=e/b.length;null==vd[g]&&(vd[g]=fe(fp(b.map(a=>a.label)),a.width*h,a.height*f)),b.forEach((b,e)=>{if(b){var i=a.pa(c+e*h,d,h,f,"button",b.id);i.pf(b.action),i.pc(b.label,!1,vd[g]),0<e&&i.pd("button_separator")}})}function fG(a,b,c){var d=a.pa(0,1-vh,1,vh);d.pd("toolbar"),fF(d,b,0,0,1,1,c)}function fH(a,b){var c=a.pa(0,0,1,vg),d="l";null==vd[d]&&(vd[d]=fe(b,c.width,c.height)),c.pc(b,!1,vd[d]),c.pd("header")}function fI(a,b,c){var d=fd(b,!0)?vg:0,e=fd(c,!0)?vh:0,f=a.pa(0,d,1,1-d-e);return f.pd("content"),f}function fJ(a,b,c,d){return b&&fH(a,b),c&&fG(a,c,d),fI(a,b,c)}var vi=null;function fK(){var a=fJ(ve.ij,vz,[new fE(vq,()=>{fM(7),ve.pk(),ve.pi(3)}),new fE(vn,()=>{fM(7),ve.pi(0)})],"m"),b=ve.ia,c=1,d=.4;b.ig=b.if;var e=fs(a,c,d,"XX:XX","n",250),f=a.pa(0,0,c,d,"div","o");f.dom.style.fontSize=e+"px",f.pc(fo(b.if));var g=[new fE(vA,()=>{fL(),fM(8)},"p"),new fE(vC,()=>{fM(7)}),new fE(vD,()=>{fM(7),fM(8)})];fF(a,g,0,.4,1,.1,"q")}function fL(){if(null===vi){var a=fP(0,.1);vi=new Audio(a),vi.play()}}function fM(a){var b=ve.ia,c=fa("o"),d=fa("p");if(8==a){if(null!=b.ih)return b.ih=fq(b.ih),void(d.innerHTML=vA);0==b.ig&&fM(7),d.innerHTML=vB,b.ih=setInterval(()=>{c.innerHTML=fo(--b.ig),0==b.ig&&(b.ih=fq(b.ih),vi.src=fP(440,2),vi.play(),c.innerHTML=vE,d.innerHTML=vA)},1e3)}else 7==a?(b.ih=fq(b.ih),b.ig=b.if,c.innerHTML=fo(b.ig),d.innerHTML=vA):fb("Timer","CountdownControl","Invalid action name: "+a)}function fN(){var a=fJ(ve.ij,vq,[new fE(vm,()=>{ve.pi(2)}),new fE(vn,()=>{ve.pl(),ve.pi(2)})],"r"),b=1,c=.4,d=fs(a,b,c,"XX:XX","s",250),e=a.pa(0,0,b,c,"div","t");e.dom.style.fontSize=d+"px";var f=["-10","-5","-1","+1","+5","+10"].map(a=>new fE(a,()=>{fO(parseInt(a))}));fF(a,f,0,.4,1,.1,"u"),fO(0)}function fO(a){var b=ve.ia;0>=b.if+a?b.if=1:b.if+=a,fa("t").innerHTML=fo(b.if)}function fP(a,b){for(var c=1,d=22050,e=8,f=new Uint8Array(b*d),g=0;g<f.length;g++)f[g]=126*Math.sin(2*g*Math.PI/(d/a))+128;var h=["RIFF",fQ(1,52),"WAVEfmt ",fQ(1,16),fQ(0,1),fQ(0,c),fQ(1,d),fQ(1,d*c*e/8),fQ(0,c*e/8),fQ(0,e),"data",fQ(1,f.length*c*e/8),f],j=new window.Blob(h,{type:"audio/wav"}),k=(window.URL||window.webkitURL).createObjectURL(j);return k}function fQ(a,b){return[new Uint8Array([b,b>>8]),new Uint8Array([b,b>>8,b>>16,b>>24])][a]}var vj="Who'll start?",vk="Throw dice",vl="Toss coin",vm="Apply",vn="Back",vo="Head",vp="Tail",vq="Settings",vr="Timer",vs="Initial score",vt="Initial subscore",vu="Enable subscore",vv="Enable throw history",vw="Dice count",vx="Player count",vy="Player colors",vz="Countdown",vA="\u25B7",vB="\u2758 \u2758",vC="\u25FB",vD="\u27F2",vE="TIME UP",vF=["\u2680","\u2681","\u2682","\u2683","\u2684","\u2685"];