"use strict";var version="3.0.0",va=1,vb=!1;function fa(a){return document.getElementById(a)}function fb(a,b,c){var d="ERROR: "+a+"::"+b+": "+c;console.error(d),0<va&&alert(d)}function fc(a,b){return Math.floor(Math.random()*b+a)}function fd(a,b){return"undefined"==typeof a?b:a}function fe(a,b,c,d,e,f){var g=1,h=fd(d,100);b*=fd(e,.8),c*=fd(f,.8);var i=fa("HiddenResizer");for(i.innerHTML=a;1<h-g;){var j=parseInt((g+h)/2);i.style.fontSize=j+"px",i.offsetWidth<=b&&i.offsetHeight<=c?g=j:h=j}return g}function ff(){this.dom=null,this.width=0,this.height=0}ff.prototype.pa=function(a,b,c,d,e,f){e=fd(e,"div"),f=fd(f,null);var g=new ff,h=document.createElement(e);return null!=f&&h.setAttribute("id",f),this.dom.appendChild(h),g.dom=h,g.width=this.width*c,g.height=this.height*d,g.dom.style.position="absolute",g.dom.style.left=this.width*a+"px",g.dom.style.top=this.height*b+"px",g.dom.style.width=g.width+"px",g.dom.style.height=g.height+"px","input"==e&&(g.pe("focus",()=>{vb=!0}),g.pe("blur",()=>{setTimeout(()=>{vb=!1},500)})),g},ff.prototype.pb=function(a){this.dom.style.background=a},ff.prototype.pc=function(a,b,c){b=fd(b,!1);var d=null;b?(c=fd(c,100),d=fe(a,this.width,this.height,c)):"undefined"!==c&&(d=c);var e=document.createTextNode(a);null!=d&&(this.dom.style.fontSize=d+"px"),this.dom.appendChild(e)},ff.prototype.pd=function(a){this.dom.className+=" "+a},ff.prototype.pe=function(a,b){this.dom.addEventListener(a,b)},ff.prototype.pf=function(a){this.pe("click",a)};function fg(){}fg.prototype.pg=function(){fb("ClassView","render","This method is not implemented!")};function fh(){this.context={},this.canvas=new ff,this.views={},this.currentView=""}fh.prototype.ph=function(a,b){var c=this.views;return c.hasOwnProperty(b)?(fb("ClassApp","addView","View with name "+b+" already exists!"),!1):(c[b]=a,!0)},fh.prototype.pi=function(a){return this.views.hasOwnProperty(a)?void(this.currentView=a,this.pg(),vb=!1):void fb("ClassApp","toggleView","View called "+a+" does not exist!")},fh.prototype.pg=function(){var a=this.canvas;a.dom.innerHTML="",a.width=window.innerWidth,a.height=window.innerHeight,a.dom.style.position="absolute",a.dom.style.width=a.width+"px",a.dom.style.height=a.height+"px",this.views[this.currentView].pg()},fh.prototype.pj=function(a){this.canvas.dom=fa(a),window.addEventListener("resize",()=>{vb||(fs(),this.pg())})};var vc=fk;function fi(){var a=Math.min,b=fR(ve.canvas,vj,[new fM(vk,()=>{vc=fk,fj()}),new fM(vl,()=>{vc=fl,fj()}),new fM(vo,()=>{ve.pi(0)})],"a"),c=ve.context.useHistory?.1:0,d=1-c;b.pf(()=>{fj()});var e=b.pa(0,0,1,d,"div","b"),f=fe(fq([vJ[0].repeat(ve.context.diceCount),vp,vq]),b.width,b.height,a(b.width,b.height));if(e.pc("??",!1,f),ve.context.useHistory){var g=b.pa(0,d,1,c,"div","c"),h=ft(g,1,1,"Lorem ipsum dolor sit amet","d",150);g.pc(ve.context.history,!1,h),g.pd("align_left"),g.pd("nowrap")}}function fj(){fa("b").innerHTML="...",setTimeout(()=>{vc(),fm()},500)}function fk(){var a=fa("b");a.innerHTML="";for(var b=0;b<ve.context.diceCount;b++)a.innerHTML+=vJ[fc(1,6)-1]}function fl(){fa("b").innerHTML=[vp,vq][fc(1,2)-1]}function fm(){var a=ve.context;if(a.useHistory){var b="";a.history&&(b=", "),a.history=fa("b").innerHTML+b+a.history.substr(0,1024),fa("c").innerHTML=a.history}}function fn(){this.score=0,this.subscore=0,this.color="red"}function fo(a){var b="0"+(Math.floor(a/60)+"");return b.slice(-2)+":"+("0"+(a%60+"")).slice(-2)}function fp(){return fc(268435456,4294967295).toString(16)}function fq(a){return a.reduce(function(c,a){return c.length>a.length?c:a})}function fr(a){return clearInterval(a),null}var vd={};function fs(){vd={}}function ft(a,b,c,d,e,f){var g=fd(f,100);return null==vd[e]&&(vd[e]=fe(d,a.width*b,a.height*c,g)),vd[e]}var ve=new fh;fh.prototype.pk=function(){this.backup=JSON.parse(JSON.stringify(this.context))},fh.prototype.pl=function(){this.context=JSON.parse(JSON.stringify(this.backup))};function Main(){ve.pj("Canvas"),ve.backup={},ve.context.players=[],ve.context.initScore=0,ve.context.initSubscore=0,ve.context.numOfPlayers=4,ve.context.colorSetup=[0,1,2,3,4,5,6,7],ve.context.initCountdown=30,ve.context.countdown=0,ve.context.cntIntHndl=null,ve.context.useSubscore=!1,ve.context.useRemote=!1,ve.context.useHistory=!0,ve.context.history="",ve.context.diceCount=3,ve.context.apikey=fp();for(var a=0;a<ve.context.numOfPlayers;a++)ve.context.players.push(new fn),ve.context.players[a].score=ve.context.initScore,ve.context.players[a].color=vf[ve.context.colorSetup[a]];for(var b,c=[{callback:fA,name:0},{callback:fE,name:1},{callback:fS,name:2},{callback:fV,name:3},{callback:fi,name:4},{callback:fu,name:5}],a=0;a<c.length;a++)b=new fg,b.pg=c[a].callback,ve.ph(b,c[a].name);ve.pi(0)}function fu(){var a=fR(ve.canvas,vt,[new fM(vm,()=>{fx(),ve.pi(0)}),new fM(vo,()=>{ve.pi(1)})],"e");fv(a.pa(0,0,1,.5))}function fv(a){var b=a.pa(0,0,1,.3);b.pc("Enter AppID of remote device:",!0);var c=a.pa(.05,.35,.9,.2,"input","f");fw(c)}function fw(a){a.dom.type="text",a.dom.value="",a.dom.autocomplete="off"}function fx(){var a=fa("f").value;window.addEventListener("mousedown",b=>{var c=fz(a,"POST");c.onreadystatechange=function(){};var d=b.clientX/ve.canvas.width,e=b.clientY/ve.canvas.height;c.send(JSON.stringify([d,e]))})}function fy(){var a=fz(ve.context.apikey,"GET");a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var b=JSON.parse(a.responseText);document.elementFromPoint(b[0]*ve.canvas.width,b[1]*ve.canvas.height).click(),fy()}},a.send()}function fz(a,b){var c=new XMLHttpRequest;return void 0===c?void alert("Cannot send messages!"):(c.open(b,"https://httprelay.io/link/"+a,!0),c)}function fA(){var a=fR(ve.canvas,"",[new fM(vj,()=>{ve.pi(4)}),new fM(vs,()=>{ve.pi(2)}),new fM(vr,()=>{ve.pk(),ve.pi(1)})],"g");a.dom.className="",fB(a)}function fB(a){for(var b=ve.context.players.length,c=2==b?1:2,d=Math.ceil(b/c),e=1/c,f=1/d,g=0,h=0;h<d;h++)for(var i=0;i<c;i++)if(1==b%2&&g+1==b&&(e=1),[6,7].forEach(b=>{var c=a.pa(i*e,h*f,e,f,"div","h"+b+g);c.pb(ve.context.players[g].color),fC(g,c,b)}),fa("h7"+g).style.display="none",g++,b==g)return}function fC(a,b,c){var d=6==c?"score":"subscore",e=ft(b,.25,1,"XX","i",250),f=ve.context.players,g=b.pa(.25,0,.5,1,"div","j"+d+a);g.dom.style.fontSize=e+"px",7==c&&g.pd("outline"),ve.context.useSubscore&&g.pf(()=>{b.dom.style.display="none",fa("h"+(6==c?7:6)+a).style.display=""}),["-","+"].forEach((c,g)=>{var h=b.pa(.75*g,0,.25,1,"button");h.pc(c,!1,e),h.pf(()=>{fD(f,a,parseInt(c+"1"),!1,d)}),h.pd("score_btn")}),fD(f,a,f[a][d],!0,d)}function fD(a,b,c,d,e){a[b][e]=(d?0:parseInt(a[b][e]))+c,fa("j"+e+b).innerHTML=a[b][e]}var vf=["red","lightgreen","lightblue","yellow","pink","orange","grey","#f5f5f5"];function fE(){var a=fR(ve.canvas,vr,[new fM(vm,()=>{fL(),ve.pi(0)}),new fM(vt,()=>{fL(),ve.pi(5)}),new fM(vo,()=>{ve.pl(),ve.pi(0)})],"k");a.pd("scrollable");var b=Math.max(ve.context.numOfPlayers+ve.context.useSubscore+5,9),c=a.pa(0,0,1,b/9);fF(c,b)}function fF(a,b){var c=.6,d=1/b,e=[[(a,b)=>{fG(2,8,a,b)},"select","numOfPlayers",vB],[(a,b)=>{fG(1,6,a,b)},"select","diceCount",vA],[fI,"input","useSubscore",vw],[fI,"input","useHistory",vx],[fH,"input","initScore",vu],ve.context.useSubscore?[fH,"input","initSubscore",vv]:null,[fI,"input","useRemote",vy],ve.context.useRemote?[fJ,"div","apikey",vz]:null].filter(a=>a),f=ft(a,c,d,fq(e.map(a=>a[3])),"l");e.forEach((b,e)=>{var g=a.pa(0,e*d,c,d);g.pd("align_left"),g.pc(b[3],!1,f);var h=a.pa(c,e*d,1-c,.9*d,b[1]);b[0](h,b[2])});var g=e.length,h=a.pa(0,g++*d,1,d);h.dom.style.fontWeight="bold",h.pc(vC,!1,f);var i=a.pa(0,g*d,1,ve.context.numOfPlayers*d);fK(i)}function fG(a,b,c,e){c.pe("change",a=>{var b=a.target;ve.context[e]=parseInt(b.options[b.selectedIndex].value),ve.pi(1)});for(var f=a;f<=b;f++)(function(a){var b=c.pa(0,0,1,1,"option");b.value=f,b.pc(f),a==ve.context[e]&&(b.dom.selected="selected")})(f)}function fH(a,b){a.dom.type="number",a.dom.value=ve.context[b],a.dom.autocomplete="off",a.pe("input",()=>{a.dom.validity.valid&&(ve.context[b]=a.dom.value)})}function fI(a,b){a.dom.type="checkbox",a.dom.checked=ve.context[b],a.pf(()=>{ve.context[b]=!ve.context[b],ve.pi(1)})}function fJ(a,b){a.pc(ve.context[b])}function fK(a){for(var b=1/vf.length,c=1/ve.context.numOfPlayers,d=0;d<ve.context.numOfPlayers;d++)for(var e=0;e<vf.length;e++)(function(d,e){var f=a.pa(e*b,d*c,b,c);f.pb(vf[e]);var g="";ve.context.colorSetup[d]==e&&(g="checked"),f.dom.innerHTML="<input type=\"radio\" name=\"m"+d+"\" value=\""+e+"\" "+g+">",f.pf(()=>{ve.context.colorSetup[d]=e})})(d,e)}function fL(){for(var a=ve.context,b=a.players;a.numOfPlayers<b.length;)b.pop();for(;a.numOfPlayers>b.length;)b.push(new fn);for(var c=0;c<b.length;c++)b[c].color=vf[a.colorSetup[c]],b[c].score=parseInt(a.initScore),b[c].subscore=parseInt(a.initSubscore);ve.context.useRemote&&fy()}var vg=.0807,vh=vg;function fM(a,b,c){this.label=a,this.action=b,this.id=fd(c,null)}function fN(a,b,c,d,e,f,g){var h=e/b.length;null==vd[g]&&(vd[g]=fe(fq(b.map(a=>a.label)),a.width*h,a.height*f)),b.forEach((b,e)=>{if(b){var i=a.pa(c+e*h,d,h,f,"button",b.id);i.pf(b.action),i.pc(b.label,!1,vd[g]),0<e&&i.pd("button_separator")}})}function fO(a,b,c){var d=a.pa(0,1-vh,1,vh);d.pd("toolbar"),fN(d,b,0,0,1,1,c)}function fP(a,b){var c=a.pa(0,0,1,vg),d="n";null==vd[d]&&(vd[d]=fe(b,c.width,c.height)),c.pc(b,!1,vd[d]),c.pd("header")}function fQ(a,b,c){var d=fd(b,!0)?vg:0,e=fd(c,!0)?vh:0,f=a.pa(0,d,1,1-d-e);return f.pd("content"),f}function fR(a,b,c,d){return b&&fP(a,b),c&&fO(a,c,d),fQ(a,b,c)}var vi=null;function fS(){var a=fR(ve.canvas,vD,[new fM(vr,()=>{fU(8),ve.pk(),ve.pi(3)}),new fM(vo,()=>{fU(8),ve.pi(0)})],"o"),b=ve.context,c=1,d=.4;b.countdown=b.initCountdown;var e=ft(a,c,d,"XX:XX","p",250),f=a.pa(0,0,c,d,"div","q");f.dom.style.fontSize=e+"px",f.pc(fo(b.initCountdown));var g=[new fM(vE,()=>{fT(),fU(9)},"r"),new fM(vG,()=>{fU(8)}),new fM(vH,()=>{fU(8),fU(9)})];fN(a,g,0,.4,1,.1,"s")}function fT(){if(null===vi){var a=fY(0,.1);vi=new Audio(a),vi.play()}}function fU(a){var b=ve.context,c=fa("q"),d=fa("r");if(9==a){if(null!=b.cntIntHndl)return b.cntIntHndl=fr(b.cntIntHndl),void(d.innerHTML=vE);0==b.countdown&&fU(8),d.innerHTML=vF,b.cntIntHndl=setInterval(()=>{c.innerHTML=fo(--b.countdown),0==b.countdown&&(b.cntIntHndl=fr(b.cntIntHndl),vi.src=fY(440,2),vi.play(),c.innerHTML=vI,d.innerHTML=vE)},1e3)}else 8==a?(b.cntIntHndl=fr(b.cntIntHndl),b.countdown=b.initCountdown,c.innerHTML=fo(b.countdown),d.innerHTML=vE):fb("Timer","CountdownControl","Invalid action name: "+a)}function fV(){var a=fR(ve.canvas,vr,[new fM(vm,()=>{ve.pi(2)}),new fM(vo,()=>{ve.pl(),ve.pi(2)})],"t"),b=1,c=.4,d=ft(a,b,c,"XX:XX","u",250),e=a.pa(0,0,b,c,"div","v");e.dom.style.fontSize=d+"px";var f=["-10","-5","-1","+1","+5","+10"].map(a=>new fM(a,()=>{fX(parseInt(a))}));fN(a,f,0,.4,1,.1,"w"),fX(0)}function fX(a){var b=ve.context;0>=b.initCountdown+a?b.initCountdown=1:b.initCountdown+=a,fa("v").innerHTML=fo(b.initCountdown)}function fY(a,b){for(var c=1,d=22050,e=8,f=new Uint8Array(b*d),g=0;g<f.length;g++)f[g]=126*Math.sin(2*g*Math.PI/(d/a))+128;var h=["RIFF",fZ(1,52),"WAVEfmt ",fZ(1,16),fZ(0,1),fZ(0,c),fZ(1,d),fZ(1,d*c*e/8),fZ(0,c*e/8),fZ(0,e),"data",fZ(1,f.length*c*e/8),f],j=new window.Blob(h,{type:"audio/wav"}),k=(window.URL||window.webkitURL).createObjectURL(j);return k}function fZ(a,b){return[new Uint8Array([b,b>>8]),new Uint8Array([b,b>>8,b>>16,b>>24])][a]}var vj="Kdo za\u010Dne?",vk="Ho\u010F kostkami",vl="Ho\u010F minc\xED",vm="Pou\u017E\xEDt",vn="Start",vo="Zp\u011Bt",vp="Hlava",vq="Orel",vr="Nastaven\xED",vs="Nezdr\u017Euj",vt="Vzd\xE1len\xE1 spr\xE1va",vu="Po\u010D\xE1te\u010Dn\xED sk\xF3re",vv="Po\u010D\xE1te\u010Dn\xED subsk\xF3re",vw="Zapnout subsk\xF3re",vx="Zapnout historii hod\u016F",vy="Povolit vzd\xE1lenou spr\xE1vu",vz="AppID",vA="Po\u010Det kostek",vB="Po\u010Det hr\xE1\u010D\u016F",vC="Barvy hr\xE1\u010D\u016F",vD="Odpo\u010Det",vE="\u25B7",vF="\u2758 \u2758",vG="\u25FB",vH="\u27F2",vI="KONEC",vJ=["\u2680","\u2681","\u2682","\u2683","\u2684","\u2685"];